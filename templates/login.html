<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connexion - ADI Quality Dashboard</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>✈️</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        :root {
            --marine-blue: #1a237e;
            --deep-marine: #0d47a1;
            --light-marine: #3949ab;
            --accent-red: #d32f2f;
            --bright-red: #f44336;
            --pure-white: #ffffff;
            --light-gray: #f5f7fa;
            --medium-gray: #90a4ae;
            --dark-gray: #37474f;
            --shadow-light: rgba(26, 35, 126, 0.08);
            --shadow-medium: rgba(26, 35, 126, 0.15);
            --shadow-heavy: rgba(26, 35, 126, 0.25);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--marine-blue) 0%, var(--deep-marine) 50%, var(--light-marine) 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        /* Animated background elements */
        body::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(211, 47, 47, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.08) 0%, transparent 50%);
            animation: backgroundFloat 20s ease-in-out infinite;
        }

        body::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.02) 50%, transparent 70%),
                linear-gradient(-45deg, transparent 30%, rgba(211, 47, 47, 0.02) 50%, transparent 70%);
            animation: shimmer 15s linear infinite;
        }

        @keyframes backgroundFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .login-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 28px;
            padding: 3rem 2.5rem;
            box-shadow: 
                0 40px 80px var(--shadow-heavy),
                0 20px 40px var(--shadow-medium),
                0 8px 16px var(--shadow-light),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            width: 100%;
            max-width: 460px;
            position: relative;
            overflow: hidden;
            z-index: 10;
            transform: translateY(20px);
            animation: slideInUp 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        @keyframes slideInUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }



        .content-wrapper {
            position: relative;
            z-index: 2;
        }

        /* Logo section */
        .logo-section {
            text-align: center;
            margin-bottom: 3rem;
            animation: logoEntrance 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55) 0.3s both;
        }

        @keyframes logoEntrance {
            0% {
                transform: scale(0) rotate(-180deg);
                opacity: 0;
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .logo-container {
            position: relative;
            display: inline-block;
            margin-bottom: 1.5rem;
        }

        .logo-container::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: conic-gradient(from 0deg, var(--marine-blue), var(--accent-red), var(--marine-blue));
            border-radius: 50%;
            animation: logoRing 4s linear infinite;
            opacity: 0.3;
        }

        @keyframes logoRing {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .logo-container img {
            width: 110px;
            height: 80px;
            object-fit: contain;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 8px 24px var(--shadow-medium));
            animation: logoFloat 3s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        .brand-title {
            color: var(--marine-blue);
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            letter-spacing: -0.03em;
            background: linear-gradient(135deg, var(--marine-blue), var(--accent-red));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: titlePulse 2s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .brand-subtitle {
            color: var(--medium-gray);
            font-size: 1.1rem;
            font-weight: 500;
            opacity: 0.9;
        }

        /* Form styling */
        .login-form {
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 2rem;
            position: relative;
            animation: formSlide 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
        }

        .form-group:nth-child(1) { animation-delay: 0.4s; }
        .form-group:nth-child(2) { animation-delay: 0.6s; }

        @keyframes formSlide {
            0% {
                transform: translateX(-30px);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .form-control {
            width: 100%;
            padding: 1.2rem 1rem 1.2rem 3.5rem;
            border: 2px solid #e3f2fd;
            border-radius: 16px;
            font-size: 1rem;
            font-weight: 500;
            background: rgba(255, 255, 255, 0.9);
            color: var(--dark-gray);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(10px);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--marine-blue);
            background: var(--pure-white);
            box-shadow: 
                0 0 0 4px rgba(26, 35, 126, 0.1),
                0 12px 32px var(--shadow-medium);
            transform: translateY(-3px);
        }

        .form-control:valid {
            border-color: #4caf50;
        }

        .form-control::placeholder {
            color: var(--medium-gray);
            font-weight: 400;
        }

        .input-icon {
            position: absolute;
            left: 1.2rem;
            color: var(--medium-gray);
            font-size: 1.1rem;
            transition: all 0.3s ease;
            z-index: 2;
        }

        .form-control:focus + .input-icon {
            color: var(--marine-blue);
            transform: scale(1.1);
        }

        /* Password toggle */
        .password-toggle {
            position: absolute;
            right: 1.2rem;
            color: var(--medium-gray);
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            z-index: 3;
            padding: 0.5rem;
        }

        .password-toggle:hover {
            color: var(--marine-blue);
            transform: scale(1.1);
        }

        .password-toggle.active {
            color: var(--accent-red);
        }

        /* Submit button */
        .btn-submit {
            width: 100%;
            padding: 1.3rem 2rem;
            background: linear-gradient(135deg, var(--marine-blue) 0%, var(--deep-marine) 50%, var(--accent-red) 100%);
            border: none;
            border-radius: 16px;
            color: var(--pure-white);
            font-size: 1.1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 
                0 8px 24px var(--shadow-medium),
                0 4px 12px rgba(211, 47, 47, 0.2);
            animation: buttonEntrance 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.8s both;
        }

        @keyframes buttonEntrance {
            0% {
                transform: translateY(30px) scale(0.9);
                opacity: 0;
            }
            100% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .btn-submit::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .btn-submit:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 16px 48px var(--shadow-heavy),
                0 8px 24px rgba(211, 47, 47, 0.3);
            background: linear-gradient(135deg, var(--deep-marine) 0%, var(--marine-blue) 50%, #c62828 100%);
        }

        .btn-submit:hover::before {
            left: 100%;
        }

        .btn-submit:active {
            transform: translateY(-2px);
        }

        .btn-submit:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .btn-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
        }

        .spinner-border-sm {
            width: 1.2rem;
            height: 1.2rem;
            border-width: 2px;
        }

        /* Back link */
        .back-link {
            text-align: center;
            margin-top: 2.5rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(26, 35, 126, 0.1);
            animation: linkFade 0.8s ease-out 1s both;
        }

        @keyframes linkFade {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .back-link a {
            color: var(--marine-blue);
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.6rem;
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
        }

        .back-link a::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(135deg, var(--marine-blue), var(--accent-red));
            transition: width 0.3s ease;
            z-index: -1;
        }

        .back-link a:hover {
            color: var(--pure-white);
            transform: translateY(-2px);
        }

        .back-link a:hover::before {
            width: 100%;
        }

        /* Alert styling */
        .alert {
            border-radius: 16px;
            border: none;
            padding: 1.2rem 1.5rem;
            margin-bottom: 2rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
            animation: alertSlide 0.5s ease-out;
        }

        @keyframes alertSlide {
            0% {
                transform: translateY(-20px);
                opacity: 0;
            }
            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .alert-danger {
            background: linear-gradient(135deg, rgba(211, 47, 47, 0.1), rgba(244, 67, 54, 0.05));
            color: var(--accent-red);
            border-left: 4px solid var(--accent-red);
        }

        .alert-success {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(129, 199, 132, 0.05));
            color: #2e7d32;
            border-left: 4px solid #4caf50;
        }

        /* Responsive design */
        @media (max-width: 576px) {
            .login-container {
                margin: 1rem;
                padding: 2.5rem 2rem;
                border-radius: 24px;
            }
            
            .brand-title {
                font-size: 1.9rem;
            }

            .form-control {
                padding: 1.1rem 0.9rem 1.1rem 3.2rem;
            }

            .btn-submit {
                padding: 1.2rem 1.5rem;
                font-size: 1rem;
            }
        }

        @media (max-width: 390px) {
            .login-container {
                padding: 2rem 1.5rem;
            }
            
            .brand-title {
                font-size: 1.7rem;
            }
        }

        /* Loading state */
        .loading .form-control {
            pointer-events: none;
            opacity: 0.7;
        }

        .loading .btn-submit {
            background: linear-gradient(135deg, var(--medium-gray), var(--dark-gray));
        }
    </style>
</head>
<body>
    <div class="login-container" data-aos="zoom-in" data-aos-duration="1000">
        <div class="content-wrapper">
            <!-- Logo & Brand Section -->
            <div class="logo-section">
                <div class="logo-container">
                    <img src="{{ url_for('static', filename='images/logo1.png') }}" alt="Logo">
                </div>
                <h1 class="brand-title">Connexion ADI</h1>
                <p class="brand-subtitle">Tableau de bord Qualité</p>
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                            <i class="fas fa-{{ 'exclamation-triangle' if category == 'error' else 'check-circle' }} me-2"></i>
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- Login Form -->
            <form method="POST" id="loginForm" class="login-form">
                <div class="form-group">
                    <div class="input-wrapper">
                        <input type="text" 
                               class="form-control" 
                               id="nom_compte" 
                               name="nom_compte" 
                               placeholder="Entrez votre nom de compte" 
                               required>
                        <i class="fas fa-user input-icon"></i>
                    </div>
                </div>

                <div class="form-group">
                    <div class="input-wrapper">
                        <input type="password" 
                               class="form-control" 
                               id="mot_de_passe" 
                               name="mot_de_passe" 
                               placeholder="Entrez votre mot de passe" 
                               required>
                        <i class="fas fa-lock input-icon"></i>
                        <i class="fas fa-eye password-toggle" 
                           id="passwordToggle" 
                           title="Afficher/Masquer le mot de passe"></i>
                    </div>
                </div>

                <button type="submit" class="btn-submit" id="submitBtn">
                    <div class="btn-content">
                        <i class="fas fa-sign-in-alt" id="submitIcon"></i>
                        <span id="submitText">Se connecter</span>
                        <div class="spinner-border spinner-border-sm d-none" id="submitSpinner"></div>
                    </div>
                </button>
            </form>

            <!-- Back to Home -->
            <div class="back-link">
                <a href="{{ url_for('home') }}">
                    <i class="fas fa-arrow-left"></i>
                    Retour à l'accueil
                </a>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    
    <script>
        // Initialize AOS
        AOS.init({
            duration: 1000,
            once: true,
            easing: 'ease-out-cubic'
        });

        // Password toggle functionality
        const passwordToggle = document.getElementById('passwordToggle');
        const passwordInput = document.getElementById('mot_de_passe');

        passwordToggle.addEventListener('click', function() {
            const isPassword = passwordInput.type === 'password';
            
            passwordInput.type = isPassword ? 'text' : 'password';
            
            this.classList.remove('fa-eye', 'fa-eye-slash');
            this.classList.add(isPassword ? 'fa-eye-slash' : 'fa-eye');
            this.classList.toggle('active', isPassword);
            
            // Animation effect
            this.style.transform = 'scale(1.2)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 150);
            
            // Update title
            this.title = isPassword ? 'Masquer le mot de passe' : 'Afficher le mot de passe';
        });

        // Form submission handling
        const loginForm = document.getElementById('loginForm');
        const submitBtn = document.getElementById('submitBtn');
        const submitText = document.getElementById('submitText');
        const submitIcon = document.getElementById('submitIcon');
        const submitSpinner = document.getElementById('submitSpinner');

        loginForm.addEventListener('submit', function(e) {
            // Add loading state
            document.body.classList.add('loading');
            submitText.textContent = 'Connexion en cours...';
            submitIcon.classList.add('d-none');
            submitSpinner.classList.remove('d-none');
            submitBtn.disabled = true;
            
            // Add visual feedback
            submitBtn.style.transform = 'scale(0.98)';
            setTimeout(() => {
                submitBtn.style.transform = '';
            }, 200);
            
            // Reset after 5 seconds if no redirect
            setTimeout(() => {
                document.body.classList.remove('loading');
                submitText.textContent = 'Se connecter';
                submitIcon.classList.remove('d-none');
                submitSpinner.classList.add('d-none');
                submitBtn.disabled = false;
            }, 5000);
        });

        // Enhanced form validation with animations
        const inputs = document.querySelectorAll('.form-control');
        
        inputs.forEach((input, index) => {
            // Focus animations
            input.addEventListener('focus', function() {
                this.parentElement.style.transform = 'translateY(-2px)';
                
                // Animate input icon
                const icon = this.nextElementSibling;
                if (icon && icon.classList.contains('input-icon')) {
                    icon.style.transform = 'scale(1.1) translateX(2px)';
                }
            });

            input.addEventListener('blur', function() {
                this.parentElement.style.transform = '';
                
                // Reset icon animation
                const icon = this.nextElementSibling;
                if (icon && icon.classList.contains('input-icon')) {
                    icon.style.transform = '';
                }
                
                // Validation
                if (this.value.trim() === '') {
                    this.style.borderColor = '#f44336';
                    this.style.boxShadow = '0 0 0 2px rgba(244, 67, 54, 0.2)';
                } else {
                    this.style.borderColor = '#4caf50';
                    this.style.boxShadow = '0 0 0 2px rgba(76, 175, 80, 0.2)';
                    
                    // Success animation
                    this.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 200);
                }
            });

            // Reset styles on input
            input.addEventListener('input', function() {
                this.style.borderColor = '';
                this.style.boxShadow = '';
            });

            // Staggered animation on load
            setTimeout(() => {
                input.style.transform = 'translateX(0)';
                input.style.opacity = '1';
            }, 500 + (index * 200));
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + Enter to submit
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                loginForm.dispatchEvent(new Event('submit'));
            }
            
            // Escape to go back
            if (e.key === 'Escape') {
                window.location.href = "{{ url_for('home') }}";
            }
            
            // Tab navigation enhancement
            if (e.key === 'Tab') {
                const focusedElement = document.activeElement;
                if (focusedElement && focusedElement.classList.contains('form-control')) {
                    setTimeout(() => {
                        const nextFocused = document.activeElement;
                        if (nextFocused && nextFocused !== focusedElement) {
                            nextFocused.style.transform = 'scale(1.02)';
                            setTimeout(() => {
                                nextFocused.style.transform = '';
                            }, 200);
                        }
                    }, 50);
                }
            }
        });

        // Auto-focus first input with delay for better UX
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('nom_compte').focus();
                
                // Add entrance animation to form
                const formGroups = document.querySelectorAll('.form-group');
                formGroups.forEach((group, index) => {
                    setTimeout(() => {
                        group.style.opacity = '1';
                        group.style.transform = 'translateX(0)';
                    }, index * 150);
                });
            }, 800);
        });

        // Add particle effect on successful validation
        function createParticles(element) {
            const rect = element.getBoundingClientRect();
            const particles = [];
            
            for (let i = 0; i < 6; i++) {
                const particle = document.createElement('div');
                particle.style.position = 'fixed';
                particle.style.width = '4px';
                particle.style.height = '4px';
                particle.style.backgroundColor = '#4caf50';
                particle.style.borderRadius = '50%';
                particle.style.left = rect.right - 20 + 'px';
                particle.style.top = rect.top + rect.height / 2 + 'px';
                particle.style.pointerEvents = 'none';
                particle.style.zIndex = '1000';
                
                document.body.appendChild(particle);
                
                const angle = (Math.PI * 2 * i) / 6;
                const velocity = 50;
                const vx = Math.cos(angle) * velocity;
                const vy = Math.sin(angle) * velocity;
                
                let x = 0, y = 0, opacity = 1;
                
                const animate = () => {
                    x += vx * 0.02;
                    y += vy * 0.02;
                    opacity -= 0.02;
                    
                    particle.style.transform = `translate(${x}px, ${y}px)`;
                    particle.style.opacity = opacity;
                    
                    if (opacity > 0) {
                        requestAnimationFrame(animate);
                    } else {
                        document.body.removeChild(particle);
                    }
                };
                
                requestAnimationFrame(animate);
            }
        }

        // Trigger particles on successful validation
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                if (this.value.trim() !== '') {
                    setTimeout(() => createParticles(this), 100);
                }
            });
        });
    </script>
</body>
</html>